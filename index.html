<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Personal job application tracker with analytics, CSV import/export, and weekly reports">
    <meta name="keywords" content="job tracker, job search, applications, career, analytics">
    <meta name="author" content="Job Tracker">
    <title>Job Tracker - Track Your Job Applications</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e40af">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Job Tracker">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
</head>

<body>
    <!-- Skip Navigation for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <a href="#dashboardSection" class="skip-link">Skip to dashboard</a>
    <a href="#adminSection" class="skip-link">Skip to admin panel</a>
    
    <!-- Tab Announcement Region for Screen Readers -->
    <div id="tab-announcement" class="sr-only" aria-live="polite" aria-atomic="true"></div>
    
    <!-- Authentication Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content auth-modal">
            <div class="modal-header">
                <h3 id="authTitle">Welcome to Job Tracker</h3>
            </div>
            <div id="authContent">
                <!-- Login Form -->
                <form id="loginForm" class="auth-form" role="form" aria-labelledby="authTitle">
                    <div class="form-group">
                        <label for="password">Enter Password</label>
                        <input type="password" id="password" name="password" required placeholder="Enter your password"
                            autocomplete="current-password" aria-describedby="passwordHelp">
                        <div id="passwordHelp" class="sr-only">Enter your password to access the job tracker application
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary" aria-label="Login to Job Tracker">Login</button>
                    </div>
                </form>

                <!-- Setup Form (shown only on first visit) -->
                <form id="setupForm" class="auth-form hidden">
                    <div class="form-group">
                        <label for="newPassword">Create Password</label>
                        <input type="password" id="newPassword" name="newPassword" required
                            placeholder="Create a new password">
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">Confirm Password</label>
                        <input type="password" id="confirmPassword" name="confirmPassword" required
                            placeholder="Confirm your password">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Set Password</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="container hidden" id="mainApp">
        <header class="header">
            <div class="header-content">
                <div>
                    <h1>Job Tracker</h1>
                    <p>Keep track of your job applications</p>
                </div>
                <div class="header-actions">
                    <div class="nav-tabs" role="tablist" aria-label="Main navigation">
                        <button id="jobsTab" class="nav-tab active" 
                            role="tab" 
                            aria-selected="true" 
                            aria-controls="main-content" 
                            aria-label="Switch to Jobs view"
                            title="Switch to Jobs view (Alt+J)">Jobs</button>
                        <button id="dashboardTab" class="nav-tab"
                            role="tab" 
                            aria-selected="false" 
                            aria-controls="dashboardSection" 
                            aria-label="Switch to Dashboard view"
                            title="Switch to Dashboard view (Alt+D)">Dashboard</button>
                        <button id="adminTab" class="nav-tab" 
                            role="tab" 
                            aria-selected="false" 
                            aria-controls="adminSection" 
                            aria-label="Switch to Admin panel view"
                            title="Switch to Admin view (Alt+A)">Admin</button>
                    </div>
                    <button id="settingsBtn" class="btn btn-secondary">Settings</button>
                    <button id="logoutBtn" class="btn btn-secondary">Log Out</button>
                </div>
            </div>
            <!-- Offline Indicator -->
            <div id="offlineIndicator" class="offline-indicator hidden" role="status" aria-live="polite">
                <span class="offline-icon">üì°</span>
                <span class="offline-text">You're offline - changes will sync when reconnected</span>
            </div>
        </header>

        <main class="main-content" id="main-content" role="tabpanel" aria-labelledby="jobsTab" aria-label="Jobs view">
            <section class="add-job-section">
                <h2>Add New Job</h2>
                <form id="jobForm" class="job-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="title">Job Title *</label>
                            <input type="text" id="title" name="title" required>
                        </div>
                        <div class="form-group">
                            <label for="company">Company *</label>
                            <input type="text" id="company" name="company" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="status">Status *</label>
                            <select id="status" name="status" required>
                                <option value="">Select Status</option>
                                <option value="Applied">Applied</option>
                                <option value="Interview Scheduled">Interview Scheduled</option>
                                <option value="Interview Completed">Interview Completed</option>
                                <option value="Offer Received">Offer Received</option>
                                <option value="Rejected">Rejected</option>
                                <option value="Withdrawn">Withdrawn</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="stage">Stage</label>
                            <select id="stage" name="stage">
                                <option value="">Select Stage</option>
                                <option value="Application Submitted">Application Submitted</option>
                                <option value="Phone Screen">Phone Screen</option>
                                <option value="Technical Interview">Technical Interview</option>
                                <option value="Onsite Interview">Onsite Interview</option>
                                <option value="Final Round">Final Round</option>
                                <option value="Negotiation">Negotiation</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="dateApplied">Date Applied *</label>
                            <input type="date" id="dateApplied" name="dateApplied" required>
                        </div>
                        <div class="form-group">
                            <label for="interviewDate">Interview Date & Time</label>
                            <input type="datetime-local" id="interviewDate" name="interviewDate">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="applicationSource">Application Source</label>
                            <select id="applicationSource" name="applicationSource">
                                <option value="">Select Source</option>
                                <option value="LinkedIn">LinkedIn</option>
                                <option value="Indeed">Indeed</option>
                                <option value="Company Website">Company Website</option>
                                <option value="Glassdoor">Glassdoor</option>
                                <option value="AngelList">AngelList</option>
                                <option value="Referral">Referral</option>
                                <option value="Recruiter">Recruiter</option>
                                <option value="Job Fair">Job Fair</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="contactPerson">Contact Person</label>
                            <input type="text" id="contactPerson" name="contactPerson">
                        </div>
                        <div class="form-group">
                            <label for="followUpDate">Follow-up Date</label>
                            <input type="date" id="followUpDate" name="followUpDate">
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label for="notes">Notes</label>
                        <textarea id="notes" name="notes" rows="3" placeholder="Add any additional notes..."></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Add Job</button>
                        <button type="reset" class="btn btn-secondary">Reset</button>
                    </div>
                </form>
            </section>

            <section class="jobs-section">
                <div class="jobs-header">
                    <h2>Your Job Applications</h2>
                    <div class="jobs-stats">
                        <span id="totalJobs">0</span> total applications
                    </div>
                </div>

                <div class="jobs-filters">
                    <select id="statusFilter" class="filter-select">
                        <option value="">All Statuses</option>
                        <option value="Applied">Applied</option>
                        <option value="Interview Scheduled">Interview Scheduled</option>
                        <option value="Interview Completed">Interview Completed</option>
                        <option value="Offer Received">Offer Received</option>
                        <option value="Rejected">Rejected</option>
                        <option value="Withdrawn">Withdrawn</option>
                    </select>
                    <button id="clearFilters" class="btn btn-secondary">Clear Filters</button>
                    <button id="addSampleData" class="btn btn-secondary">Add Sample Data (6 Jobs)</button>
                </div>

                <div class="csv-actions">
                    <div class="csv-import">
                        <input type="file" id="csvFileInput" accept=".csv" class="csv-file-input">
                        <label for="csvFileInput" class="btn btn-secondary">Import CSV</label>
                    </div>
                    <button id="exportCsv" class="btn btn-primary">Export CSV</button>
                </div>

                <div id="jobsList" class="jobs-list">
                    <!-- Jobs will be rendered here dynamically -->
                </div>

                <div id="noJobs" class="no-jobs hidden">
                    <p>No job applications yet. Add your first job above!</p>
                </div>
            </section>
        </main>

        <!-- Dashboard Section -->
        <section id="dashboardSection" class="dashboard-section hidden" role="tabpanel" aria-labelledby="dashboardTab" aria-label="Dashboard view">
            <div class="dashboard-header">
                <h2>Analytics Dashboard</h2>
                <p>Insights into your job application journey</p>
                <div class="dashboard-actions">
                    <button id="weeklyReportBtn" class="btn btn-primary">üìä Generate Weekly Report</button>
                    <button id="exportAnalyticsBtn" class="btn btn-secondary">üì§ Export Data</button>
                </div>
            </div>

            <div class="dashboard-grid">
                <!-- Summary Cards -->
                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="summary-icon">üìä</div>
                        <div class="summary-content">
                            <div class="summary-number" id="totalApplications">0</div>
                            <div class="summary-label">Total Applications</div>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="summary-icon">üìç</div>
                        <div class="summary-content">
                            <div class="summary-number" id="topSource">-</div>
                            <div class="summary-label">Top Source</div>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="summary-icon">üìà</div>
                        <div class="summary-content">
                            <div class="summary-number" id="activeApplications">0</div>
                            <div class="summary-label">Active Applications</div>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="summary-icon">‚è±Ô∏è</div>
                        <div class="summary-content">
                            <div class="summary-number" id="avgResponseTime">0</div>
                            <div class="summary-label">Days Since Last Apply</div>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="summary-icon">üéØ</div>
                        <div class="summary-content">
                            <div class="summary-number" id="interviewRate">0%</div>
                            <div class="summary-label">Interview Rate</div>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="summary-icon">‚ö°</div>
                        <div class="summary-content">
                            <div class="summary-number" id="avgResponseDays">0</div>
                            <div class="summary-label">Avg Response Days</div>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="summary-icon">üöÄ</div>
                        <div class="summary-content">
                            <div class="summary-number" id="applicationVelocity">0</div>
                            <div class="summary-label">This Month</div>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="summary-icon">üè¢</div>
                        <div class="summary-content">
                            <div class="summary-number" id="uniqueCompanies">0</div>
                            <div class="summary-label">Unique Companies</div>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="summary-icon">üìÖ</div>
                        <div class="summary-content">
                            <div class="summary-number" id="upcomingInterviews">0</div>
                            <div class="summary-label">Upcoming (7d)</div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-grid">
                    <div class="chart-container">
                        <h3>Applications by Status</h3>
                        <canvas id="statusChart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>Applications by Stage</h3>
                        <canvas id="stageChart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>Application Sources</h3>
                        <canvas id="sourceChart"></canvas>
                    </div>

                    <div class="chart-container chart-wide">
                        <h3>Applications Over Time</h3>
                        <canvas id="timelineChart"></canvas>
                    </div>
                </div>

                <!-- Timeline Trends Section -->
                <div class="timeline-trends-section">
                    <h2>Trends Over Time</h2>
                    <div class="timeline-charts-grid">
                        <div class="chart-container">
                            <h3>Top Sources Over Time</h3>
                            <canvas id="sourceTimelineChart"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h3>Stage Distribution Over Time</h3>
                            <canvas id="stageTimelineChart"></canvas>
                        </div>
                        
                        <div class="chart-container">
                            <h3>Submission Rate Over Time</h3>
                            <canvas id="submissionRateChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Advanced Analytics Charts -->
                <div class="advanced-charts-grid" style="display: none;">
                    <div class="chart-container">
                        <h3>Response Time Trends</h3>
                        <canvas id="responseTimeChart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>Source Performance</h3>
                        <canvas id="sourcePerformanceChart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>Application Velocity</h3>
                        <canvas id="velocityChart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>Company Performance</h3>
                        <canvas id="companyPerformanceChart"></canvas>
                    </div>
                </div>

                <!-- Advanced Insights Section -->
                <div class="insights-section" style="display: none;">
                    <h3>Advanced Insights</h3>
                    <div class="insights-grid">
                        <div class="insight-card" id="applicationTrends">
                            <h4>Application Trends</h4>
                            <p>Loading trends...</p>
                        </div>

                        <div class="insight-card" id="responsePatterns">
                            <h4>Response Patterns</h4>
                            <p>Loading patterns...</p>
                        </div>

                        <div class="insight-card" id="successFactors">
                            <h4>Success Factors</h4>
                            <p>Loading factors...</p>
                        </div>

                        <div class="insight-card" id="performanceMetrics">
                            <h4>Performance Metrics</h4>
                            <p>Loading metrics...</p>
                        </div>
                    </div>
                </div>


                <!-- Company Status Section -->
                <div class="company-status-section">
                    <h3>Active Company Applications</h3>
                    <div id="companyStatusList" class="company-status-list">
                        <!-- Company status items will be rendered here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Panel Section -->
        <section id="adminSection" class="admin-section hidden" role="tabpanel" aria-labelledby="adminTab" aria-label="Admin panel view">
            <div class="admin-header">
                <h2>Admin Panel</h2>
                <p>System administration and analytics</p>
            </div>
            
            <div class="admin-content">
                <!-- PWA Installation Analytics Section -->
                <div class="installation-analytics-section">
                    <h3>PWA Installation Analytics</h3>
                    <div class="installation-summary-cards">
                        <div class="summary-card">
                            <div class="summary-icon">üì±</div>
                            <div class="summary-content">
                                <div class="summary-number" id="totalInstallPrompts">0</div>
                                <div class="summary-label">Prompts Shown</div>
                            </div>
                        </div>

                        <div class="summary-card">
                            <div class="summary-icon">üëÜ</div>
                            <div class="summary-content">
                                <div class="summary-number" id="installClicks">0</div>
                                <div class="summary-label">Install Clicks</div>
                            </div>
                        </div>

                        <div class="summary-card">
                            <div class="summary-icon">üìä</div>
                            <div class="summary-content">
                                <div class="summary-number" id="conversionRate">0%</div>
                                <div class="summary-label">Conversion Rate</div>
                            </div>
                        </div>

                        <div class="summary-card">
                            <div class="summary-icon">‚úÖ</div>
                            <div class="summary-content">
                                <div class="summary-number" id="installSuccess">No</div>
                                <div class="summary-label">Installed</div>
                            </div>
                        </div>
                    </div>

                    <div class="installation-charts-grid">
                        <div class="chart-container">
                            <h3>Installation Funnel</h3>
                            <canvas id="installFunnelChart"></canvas>
                        </div>

                        <div class="chart-container">
                            <h3>Platform Breakdown</h3>
                            <canvas id="platformBreakdownChart"></canvas>
                        </div>

                        <div class="chart-container">
                            <h3>Browser Breakdown</h3>
                            <canvas id="browserBreakdownChart"></canvas>
                        </div>

                        <div class="chart-container chart-wide">
                            <h3>Installation Events Timeline</h3>
                            <canvas id="installTimelineChart"></canvas>
                        </div>
                    </div>

                    <div class="installation-actions">
                        <button id="exportInstallAnalyticsBtn" class="btn btn-secondary">üì§ Export Installation Data</button>
                        <button id="resetInstallAnalyticsBtn" class="btn btn-secondary">üîÑ Reset Analytics</button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Weekly Report Modal -->
    <div id="weeklyReportModal" class="modal hidden">
        <div class="modal-content weekly-report-modal">
            <div class="modal-header">
                <h3>Weekly Job Search Report</h3>
                <button id="closeWeeklyReport" class="close-btn">&times;</button>
            </div>
            <div class="weekly-report-content">
                <div class="report-summary">
                    <h4>Report Period: <span id="reportPeriod"></span></h4>
                    <div class="report-actions">
                        <button id="copyReportBtn" class="btn btn-secondary">üìã Copy to Clipboard</button>
                        <button id="emailReportBtn" class="btn btn-primary">üìß Email Report</button>
                    </div>
                </div>

                <div class="report-text-container">
                    <textarea id="reportText" class="report-textarea" readonly></textarea>
                </div>

                <div class="report-options">
                    <div class="form-group">
                        <label for="emailSubject">Email Subject (optional):</label>
                        <input type="text" id="emailSubject" class="form-control" placeholder="Weekly Job Search Report"
                            value="Weekly Job Search Report">
                    </div>
                    <div class="form-group">
                        <label for="emailRecipient">Email To (optional):</label>
                        <input type="email" id="emailRecipient" class="form-control"
                            placeholder="your-email@example.com">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Settings</h3>
                <button id="closeSettings" class="close-btn">&times;</button>
            </div>
            <div class="settings-content">
                <div class="settings-tabs">
                    <button type="button" class="settings-tab active" data-tab="password">Password</button>
                    <button type="button" class="settings-tab" data-tab="statuses">Statuses</button>
                    <button type="button" class="settings-tab" data-tab="stages">Stages</button>
                    <button type="button" class="settings-tab" data-tab="installation">Installation</button>
                    <button type="button" class="settings-tab" data-tab="notifications">Notifications</button>
                    <button type="button" class="settings-tab" data-tab="offline">Offline</button>
                </div>

                <!-- Password Tab -->
                <div class="settings-tab-content active" id="passwordTab">
                    <form id="changePasswordForm" class="auth-form">
                        <h4>Change Password</h4>
                        <div class="form-group">
                            <label for="currentPassword">Current Password</label>
                            <input type="password" id="currentPassword" name="currentPassword" required>
                        </div>
                        <div class="form-group">
                            <label for="settingsNewPassword">New Password</label>
                            <input type="password" id="settingsNewPassword" name="settingsNewPassword" required>
                        </div>
                        <div class="form-group">
                            <label for="settingsConfirmPassword">Confirm New Password</label>
                            <input type="password" id="settingsConfirmPassword" name="settingsConfirmPassword" required>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Change Password</button>
                        </div>
                    </form>
                </div>

                <!-- Statuses Tab -->
                <div class="settings-tab-content" id="statusesTab">
                    <div class="custom-list-section">
                        <h4>Customize Application Statuses</h4>
                        <p class="settings-description">Add, remove, or reorder the statuses used for job applications.
                        </p>

                        <div class="custom-list-container">
                            <div id="statusesList" class="custom-list">
                                <!-- Status items will be rendered here -->
                            </div>

                            <div class="add-item-form">
                                <div class="form-row">
                                    <input type="text" id="newStatusInput" placeholder="Enter new status name"
                                        class="form-control">
                                    <button type="button" id="addStatusBtn" class="btn btn-primary">Add Status</button>
                                </div>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" id="saveStatusesBtn" class="btn btn-primary">Save Statuses</button>
                            <button type="button" id="resetStatusesBtn" class="btn btn-secondary">Reset to
                                Default</button>
                        </div>
                    </div>
                </div>

                <!-- Stages Tab -->
                <div class="settings-tab-content" id="stagesTab">
                    <div class="custom-list-section">
                        <h4>Customize Application Stages</h4>
                        <p class="settings-description">Add, remove, or reorder the stages used for job applications.
                        </p>

                        <div class="custom-list-container">
                            <div id="stagesList" class="custom-list">
                                <!-- Stage items will be rendered here -->
                            </div>

                            <div class="add-item-form">
                                <div class="form-row">
                                    <input type="text" id="newStageInput" placeholder="Enter new stage name"
                                        class="form-control">
                                    <button type="button" id="addStageBtn" class="btn btn-primary">Add Stage</button>
                                </div>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" id="saveStagesBtn" class="btn btn-primary">Save Stages</button>
                            <button type="button" id="resetStagesBtn" class="btn btn-secondary">Reset to
                                Default</button>
                        </div>
                    </div>
                </div>

                <!-- Installation Tab -->
                <div class="settings-tab-content" id="installationTab">
                    <div class="installation-settings-section">
                        <h4>App Installation</h4>
                        <p class="settings-description">Install Job Tracker as a Progressive Web App for a better experience with offline access, faster loading, and desktop integration.</p>

                        <!-- Installation Status -->
                        <div class="installation-status-card">
                            <h5>Installation Status</h5>
                            <div class="status-info">
                                <div class="status-item">
                                    <span class="status-label">Status:</span>
                                    <span id="installationStatus" class="status-value">Checking...</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Platform Support:</span>
                                    <span id="platformSupport" class="status-value">-</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Browser:</span>
                                    <span id="browserInfo" class="status-value">-</span>
                                </div>
                            </div>
                        </div>

                        <!-- Installation Actions -->
                        <div class="installation-actions-card">
                            <h5>Installation Actions</h5>
                            <div class="installation-actions">
                                <button type="button" id="manualInstallBtn" class="btn btn-primary">
                                    <span class="btn-icon">üì±</span>
                                    Install App
                                </button>
                                <button type="button" id="resetInstallPrefsBtn" class="btn btn-secondary">
                                    <span class="btn-icon">üîÑ</span>
                                    Reset Preferences
                                </button>
                                <button type="button" id="checkInstallStatusBtn" class="btn btn-secondary">
                                    <span class="btn-icon">üìä</span>
                                    Check Status
                                </button>
                            </div>
                            <div id="installationActionResult" class="installation-result hidden"></div>
                        </div>

                        <!-- Installation Benefits -->
                        <div class="installation-benefits-card">
                            <h5>Installation Benefits</h5>
                            <div class="feature-list">
                                <div class="feature-item">
                                    <span class="feature-icon">üöÄ</span>
                                    <span class="feature-text">Faster loading and better performance</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">üì±</span>
                                    <span class="feature-text">Desktop and mobile app icon</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">üîå</span>
                                    <span class="feature-text">Full offline access to your data</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">ü™ü</span>
                                    <span class="feature-text">No browser tabs - runs as standalone app</span>
                                </div>
                            </div>
                        </div>

                        <!-- Installation Preferences -->
                        <div class="installation-preferences-card">
                            <h5>Installation Preferences</h5>
                            <div class="preference-info">
                                <div class="preference-item">
                                    <span class="preference-label">Prompt Count:</span>
                                    <span id="promptCount" class="preference-value">-</span>
                                </div>
                                <div class="preference-item">
                                    <span class="preference-label">Last Prompt:</span>
                                    <span id="lastPromptDate" class="preference-value">-</span>
                                </div>
                                <div class="preference-item">
                                    <span class="preference-label">Don't Ask Again:</span>
                                    <span id="dontAskAgain" class="preference-value">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notifications Tab -->
                <div class="settings-tab-content" id="notificationsTab">
                    <div class="notifications-settings-section">
                        <h4>Notifications</h4>
                        <p class="settings-description">Enable reminders for interviews and follow-ups. Notifications are handled locally and respect your privacy.</p>

                        <div class="notification-permission-card">
                            <h5>Permission</h5>
                            <div class="status-info">
                                <div class="status-item">
                                    <span class="status-label">Status:</span>
                                    <span id="notificationPermissionStatus" class="status-value">Checking...</span>
                                </div>
                            </div>
                            <div class="permission-actions">
                                <button type="button" id="requestNotificationPermissionBtn" class="btn btn-primary">Request Permission</button>
                                <button type="button" id="sendTestNotificationBtn" class="btn btn-secondary">Send Test Notification</button>
                            </div>
                        </div>

                        <div class="notification-preferences-card">
                            <h5>Preferences</h5>
                            <div class="pref-row">
                                <label class="switch">
                                    <input type="checkbox" id="notificationsEnabled">
                                    <span class="slider"></span>
                                </label>
                                <span class="switch-label">Enable Notifications</span>
                            </div>

                            <div class="pref-group">
                                <h6>Types</h6>
                                <div class="pref-row">
                                    <input type="checkbox" id="notifTypeInterviews" checked>
                                    <label for="notifTypeInterviews">Interview Reminders</label>
                                </div>
                                <div class="pref-row">
                                    <input type="checkbox" id="notifTypeFollowUps" checked>
                                    <label for="notifTypeFollowUps">Follow-up Reminders</label>
                                </div>
                                <div class="pref-row">
                                    <input type="checkbox" id="notifTypeStatusChanges">
                                    <label for="notifTypeStatusChanges">Status Change Alerts</label>
                                </div>
                            </div>

                            <div class="pref-group">
                                <h6>Interview Reminder Times</h6>
                                <div class="pref-row">
                                    <label><input type="checkbox" class="notifInterviewOffset" value="1440" checked> 24 hours before</label>
                                </div>
                                <div class="pref-row">
                                    <label><input type="checkbox" class="notifInterviewOffset" value="120" checked> 2 hours before</label>
                                </div>
                                <div class="pref-row">
                                    <label><input type="checkbox" class="notifInterviewOffset" value="30" checked> 30 minutes before</label>
                                </div>
                            </div>

                            <div class="pref-group">
                                <h6>Follow-up Timing</h6>
                                <div class="pref-row">
                                    <label><input type="checkbox" class="notifFollowUpOffset" value="72" checked> 3 days after applying</label>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="button" id="saveNotificationPrefsBtn" class="btn btn-primary">Save Preferences</button>
                                <button type="button" id="clearNotificationHistoryBtn" class="btn btn-secondary">Clear History</button>
                            </div>
                            <div id="notificationPrefsResult" class="cache-result hidden"></div>
                        </div>
                    </div>
                </div>

                <!-- Offline Tab -->
                <div class="settings-tab-content" id="offlineTab">
                    <div class="offline-settings-section">
                        <h4>Offline & Cache Management</h4>
                        <p class="settings-description">Manage offline capabilities and cached data for better
                            performance.</p>

                        <!-- Service Worker Status -->
                        <div class="cache-status-card">
                            <h5>Service Worker Status</h5>
                            <div class="status-info">
                                <div class="status-item">
                                    <span class="status-label">Status:</span>
                                    <span id="swStatus" class="status-value">Checking...</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Version:</span>
                                    <span id="swVersion" class="status-value">-</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Cached Assets:</span>
                                    <span id="cachedAssets" class="status-value">-</span>
                                </div>
                            </div>
                        </div>

                        <!-- Cache Management -->
                        <div class="cache-management-card">
                            <h5>Cache Management</h5>
                            <div class="cache-actions">
                                <button type="button" id="refreshCacheBtn" class="btn btn-secondary">
                                    <span class="btn-icon">üîÑ</span>
                                    Refresh Cache
                                </button>
                                <button type="button" id="clearCacheBtn" class="btn btn-secondary">
                                    <span class="btn-icon">üóëÔ∏è</span>
                                    Clear Cache
                                </button>
                                <button type="button" id="checkCacheBtn" class="btn btn-secondary">
                                    <span class="btn-icon">üìä</span>
                                    Check Status
                                </button>
                            </div>
                            <div id="cacheActionResult" class="cache-result hidden"></div>
                        </div>

                        <!-- Offline Features -->
                        <div class="offline-features-card">
                            <h5>Offline Features</h5>
                            <div class="feature-list">
                                <div class="feature-item">
                                    <span class="feature-icon">‚úÖ</span>
                                    <span class="feature-text">Full app functionality when offline</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">‚úÖ</span>
                                    <span class="feature-text">Automatic data synchronization</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">‚úÖ</span>
                                    <span class="feature-text">Background cache updates</span>
                                </div>
                                <div class="feature-item">
                                    <span class="feature-icon">‚úÖ</span>
                                    <span class="feature-text">Offline indicator in header</span>
                                </div>
                            </div>
                        </div>

                        <!-- Network Status -->
                        <div class="network-status-card">
                            <h5>Network Status</h5>
                            <div class="status-info">
                                <div class="status-item">
                                    <span class="status-label">Connection:</span>
                                    <span id="networkStatus" class="status-value">Checking...</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Last Online:</span>
                                    <span id="lastOnline" class="status-value">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Job Edit Modal -->
    <div id="editModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Job</h3>
                <button id="closeModal" class="close-btn">&times;</button>
            </div>
            <form id="editForm" class="job-form">
                <input type="hidden" id="editJobId">
                <div class="form-row">
                    <div class="form-group">
                        <label for="editTitle">Job Title *</label>
                        <input type="text" id="editTitle" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="editCompany">Company *</label>
                        <input type="text" id="editCompany" name="company" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editStatus">Status *</label>
                        <select id="editStatus" name="status" required>
                            <option value="Applied">Applied</option>
                            <option value="Interview Scheduled">Interview Scheduled</option>
                            <option value="Interview Completed">Interview Completed</option>
                            <option value="Offer Received">Offer Received</option>
                            <option value="Rejected">Rejected</option>
                            <option value="Withdrawn">Withdrawn</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editStage">Stage</label>
                        <select id="editStage" name="stage">
                            <option value="">Select Stage</option>
                            <option value="Application Submitted">Application Submitted</option>
                            <option value="Phone Screen">Phone Screen</option>
                            <option value="Technical Interview">Technical Interview</option>
                            <option value="Onsite Interview">Onsite Interview</option>
                            <option value="Final Round">Final Round</option>
                            <option value="Negotiation">Negotiation</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editDateApplied">Date Applied *</label>
                        <input type="date" id="editDateApplied" name="dateApplied" required>
                    </div>
                    <div class="form-group">
                        <label for="editInterviewDate">Interview Date & Time</label>
                        <input type="datetime-local" id="editInterviewDate" name="interviewDate">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editApplicationSource">Application Source</label>
                        <select id="editApplicationSource" name="applicationSource">
                            <option value="">Select Source</option>
                            <option value="LinkedIn">LinkedIn</option>
                            <option value="Indeed">Indeed</option>
                            <option value="Company Website">Company Website</option>
                            <option value="Glassdoor">Glassdoor</option>
                            <option value="AngelList">AngelList</option>
                            <option value="Referral">Referral</option>
                            <option value="Recruiter">Recruiter</option>
                            <option value="Job Fair">Job Fair</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editContactPerson">Contact Person</label>
                        <input type="text" id="editContactPerson" name="contactPerson">
                    </div>
                    <div class="form-group">
                        <label for="editFollowUpDate">Follow-up Date</label>
                        <input type="date" id="editFollowUpDate" name="followUpDate">
                    </div>
                </div>

                <div class="form-group full-width">
                    <label for="editNotes">Notes</label>
                    <textarea id="editNotes" name="notes" rows="3" placeholder="Add any additional notes..."></textarea>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Update Job</button>
                    <button type="button" id="cancelEdit" class="btn btn-secondary">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Export Analytics Modal -->
    <div id="exportModal" class="modal hidden">
        <div class="modal-content export-modal">
            <div class="modal-header">
                <h3>Export Analytics Data</h3>
                <button id="closeExportModal" class="close-btn">&times;</button>
            </div>
            <div class="export-options">
                <div class="export-option" data-format="csv">
                    <div class="export-icon">üìä</div>
                    <h4>CSV Export</h4>
                    <p>Export all job data in CSV format for spreadsheet analysis</p>
                </div>

                <div class="export-option" data-format="json">
                    <div class="export-icon">üîß</div>
                    <h4>JSON Export</h4>
                    <p>Export complete data structure in JSON format for API integration</p>
                </div>

                <div class="export-option" data-format="analytics">
                    <div class="export-icon">üìà</div>
                    <h4>Analytics Report</h4>
                    <p>Export comprehensive analytics and insights in JSON format</p>
                </div>

                <div class="export-option" data-format="summary">
                    <div class="export-icon">üìã</div>
                    <h4>Summary Report</h4>
                    <p>Export key metrics and summary statistics in JSON format</p>
                </div>
            </div>

            <div class="form-actions">
                <button id="downloadExportBtn" class="btn btn-primary" disabled>Download Export</button>
                <button id="copyExportBtn" class="btn btn-secondary" disabled>Copy to Clipboard</button>
            </div>
        </div>
    </div>

    <!-- Application Scripts -->
    <script src="js/notifications.js"></script>
    <script src="js/data.js"></script>
    <script src="js/csv.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/job-tracker.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/weekly-report.js"></script>
    <script src="js/advanced-analytics.js"></script>
    <script src="js/cross-platform-detector.js"></script>
    <script src="js/install-analytics.js"></script>
    <script src="js/install-prompt-ui.js"></script>
    <script src="js/pwa-install.js"></script>
    <script src="js/app.js"></script>
</body>

</html>